---
title: introduction
date: 2023-03-17 21:39:02
permalink: /laravel/permission/introduction/
titleTag: 原创
categories: 
  - laravel
  - permission
tags: 
  - null
author: 
  name: 诚城
  link: https://github.com/carveybunt
---

## install

```sh
composer require spatie/laravel-permission
php artisan vendor:publish --provider="Spatie\Permission\PermissionServiceProvider"
```

## settings

`/config/app.php` 文件的 `providers` 中， 添加：

```php
'providers' => [
    // ...
    Spatie\Permission\PermissionServiceProvider::class,
];
```

### UUID

启用 `uuid` 需要再 `config/permission.php` 修改代码：

```php
// 'model_morph_key' => 'model_id',
  'model_morph_key' => 'model_uuid',

// 'teams' => false,
  'teams' => true, // 是否开启团队
```

同时需要修改 `migrate` 的 `model_has_permissions` `model_has_roles` 两个表格中的：

```php
// $table->unsignedBigInteger($columnNames['model_morph_key'])
  $table->uuid($columnNames['model_morph_key'])
```

以及其他表格的 `id` 字段改为 `uuid`。

## 清除缓存

一定要执行！！！

```sh
php artisan optimize:clear
php artisan migrate # 启用UUID的，一定要先修改 migrate
```

## 使用

在用户模型中，使用 `traits` `HasRoles` 。

## auth

`config/auth.php` 设置默认的 `guard` 为 `api`。
