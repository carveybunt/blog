(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{562:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"自动生成事件和监听器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动生成事件和监听器"}},[t._v("#")]),t._v(" 自动生成事件和监听器")]),t._v(" "),a("p",[t._v("为每个事件和监听器手动创建文件是很麻烦的。相反，将监听器和事件添加到 "),a("code",[t._v("EventServiceProvider")]),t._v("中，如：")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$listen")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        ……\n        "),a("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("UserSsoEvent")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("UserSsoListen")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("使用 "),a("code",[t._v("event:generate Artisan")]),t._v(" 命令。此命令将生成 "),a("code",[t._v("EventServiceProvider")]),t._v(" 中列出的、尚不存在的任何事件或侦听器：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("php artisan event:generate\n")])])]),a("h3",{attrs:{id:"手动生成事件和监听器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动生成事件和监听器"}},[t._v("#")]),t._v(" 手动生成事件和监听器")]),t._v(" "),a("p",[t._v("使用 "),a("code",[t._v("make:event")]),t._v(" 以及 "),a("code",[t._v("make:listener")]),t._v(" 用于生成单个事件和监听器的 "),a("code",[t._v("Artisan")]),t._v(" 命令：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("php artisan make:event UserSsoEvent\n\nphp artisan make:listener UserSsoListen --event"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UserSsoEvent\n")])])]),a("p",[t._v("最后还要在将监听器和事件添加到 "),a("code",[t._v("EventServiceProvider")]),t._v("中，不如直接使用自动注册！！！")]),t._v(" "),a("h2",{attrs:{id:"定义事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定义事件"}},[t._v("#")]),t._v(" 定义事件")]),t._v(" "),a("p",[t._v("相当于与模型进行关键。")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Events")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Broadcasting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Channel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Broadcasting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("InteractsWithSockets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Broadcasting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PresenceChannel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Broadcasting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PrivateChannel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Contracts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Broadcasting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("ShouldBroadcast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Foundation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Events"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Dispatchable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Illuminate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SerializesModels")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("UserSsoEvent")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token package"}},[t._v("Dispatchable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" InteractsWithSockets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SerializesModels"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("__construct")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Get the channels the event should broadcast on.\n     *\n     * @return \\Illuminate\\Broadcasting\\Channel|array\n     */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    public function broadcastOn()")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//        return new PrivateChannel('channel-name');")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),a("p",[t._v("事件类不包含逻辑。它是一个 "),a("code",[t._v("App\\Models\\User")]),t._v(" 实例容器。 如果事件对象是使用 "),a("code",[t._v("PHP")]),t._v(" 的 "),a("code",[t._v("SerializesModels")]),t._v(" 函数序列化的，事件使用的 "),a("code",[t._v("SerializesModels")]),t._v(" "),a("code",[t._v("trait")]),t._v(" 将会优雅地序列化任何 "),a("code",[t._v("Eloquent")]),t._v(" 模型，比如在使用 队列侦听器。")]),t._v(" "),a("h2",{attrs:{id:"定义监听器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定义监听器"}},[t._v("#")]),t._v(" 定义监听器")])])}),[],!1,null,null,null);s.default=e.exports}}]);